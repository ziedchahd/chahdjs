import{c as $,b as _,e as x,i as f,a as d,I as S,D as T,g as M,t as m,h as R,s as j,j as A}from"./index-00bf0c33.js";import{T as L}from"./index-4642d62a.js";import{V as y}from"./Value-1107dbb2.js";import{c as z}from"./createField-b596c149.js";const D=m('<div tabindex="1">'),H=m('<div class="cm-tree-select-wrap">'),I={All:0,Half:1,Leaf:2,Shallow:3};function q(e){const[i,c]=z(e,e.multi?[]:""),[h,o]=$(""),C=e.align??"bottomLeft";let l,r=I[e.mode??"Half"];const g=e.checkRelation??"related",b=()=>A(e,"cm-tree-select",{"cm-tree-select-disabled":e.disabled,[`cm-tree-select-${e.size}`]:e.size}),k=t=>{e.multi||e.onChange&&e.onChange(t.id)},v=t=>{g==="related"?(c(s()),e.onChange&&e.onChange(s())):(c(t),e.onChange&&e.onChange(t))},V=()=>{const t=e.multi?[]:"";c(t),e.onChange&&e.onChange(t)},w=(t,a)=>{let n=i();n.splice(n.indexOf(t.id),1),c([...n])},s=()=>{let t=[];switch(r){case 0:{t=l.getAllChecked();break}case 1:{t=l.getHalfChecked();break}case 2:{t=l.getChildChecked();break}case 3:{t=l.getShallowChecked();break}}return t};return _(()=>{const t=i();e.multi&&t.join(",")===s().join(",")||e.multi&&(g==="unRelated"?l.setValue(t):(r===0&&l.setValue(t),r===1&&l.setValue(t),r===2&&l.setValue(t),r===3&&(t.join(",")===s().join(",")?l.setValue(l.getAllChecked()):l.setValue(l.getIfSets(t)))))}),x(()=>{let t=i();if(e.multi){if(typeof t=="string"){t=t.split(","),c(t);return}setTimeout(()=>{let a=g==="related"?s():l.getAllChecked();const n=l.getAllCheckedData(a);o(n)})}else setTimeout(()=>{const a=l.getSelectNode();o(a?a.title:"")})}),e.ref&&e.ref({...l}),(()=>{const t=D();return f(t,d(T,{get transfer(){return e.transfer},align:C,get disabled(){return e.disabled},trigger:"click",get menu(){return(()=>{const a=H();return f(a,d(L,{get data(){return e.data},get multi(){return e.multi},onSelect:k,onChange:v,ref(n){const u=l;typeof u=="function"?u(n):l=n},get value(){return i()},get selected(){return e.multi?"":[i,c]},get checkRelation(){return e.checkRelation}})),a})()},get children(){return d(y,{get text(){return h()},get multi(){return e.multi},get showMax(){return e.showMax},get disabled(){return e.disabled},get showMore(){return e.showMore},get valueClosable(){return e.valueClosable},get clearable(){return e.clearable},onClear:V,get prepend(){return e.prepend},get size(){return e.size},get icon(){return d(S,{name:"chevron-down"})},onClose:w})}})),M(a=>{const n=b(),u=e.style;return a._v$=R(t,n,a._v$),a._v$2=j(t,u,a._v$2),a},{_v$:void 0,_v$2:void 0}),t})()}export{q as T};
